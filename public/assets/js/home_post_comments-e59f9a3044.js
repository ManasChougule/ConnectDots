class PostComments{constructor(t){this.postId=t,this.postContainer=$(`#post-${t}`),this.newCommentForm=$(`#post-${t}-comments-form`),this.createComment(t);let e=this;$(".delete-comment-button",this.postContainer).each((function(){e.deleteComment($(this))}))}createComment(t){let e=this;this.newCommentForm.submit((function(n){n.preventDefault();$.ajax({type:"post",url:"/comments/create",data:$(this).serialize(),success:function(n){let o=e.newCommentDom(n.data.comment,n.data.user.name);$(`#post-comments-${t}`).prepend(o),$(`#post-${t}-comments-form`).trigger("reset"),e.deleteComment($(".delete-comment-button",o)),new ToggleLike($(" .toggle-like-button"),o),new Noty({theme:"relax",text:"Comment published!",type:"success",layout:"topRight",timeout:1500}).show()},error:function(t){}})}))}newCommentDom(t,e){const n=t.likes.length||0,o=0===n?"text-black-50":"",m=`\n            <li id="comment-${t._id}"\n                class="comment border rounded px-3 py-2 mb-2 shadow-sm position-relative">\n\n            \x3c!-- Like toggle (bottom-left) --\x3e\n            <a href="/likes/toggle/?id=${t._id}&type=Comment"\n                class="toggle-like-button like-button ${o}\n                        position-absolute bottom-0 start-0 ps-3 pb-1 d-flex align-items-center"\n                data-likes="${n}">\n                <i class="bi bi-heart-fill me-1"></i>\n                <span>${n}</span>\n            </a>\n\n            \x3c!-- Delete button (top-right) --\x3e\n            <a href="/comments/destroy/${t._id}"\n                class="delete-comment-button position-absolute top-0 end-0 mt-1 me-2">\n                <i class="bi bi-trash-fill"></i>\n            </a>\n\n            \x3c!-- Comment text --\x3e\n            <p class="mb-1">${t.content}</p>\n\n            \x3c!-- Author --\x3e\n            <div class="small text-muted fst-italic"\n                    style="padding-left: 1rem; padding-bottom: 1.5rem;">\n                â€” ${e}\n            </div>\n            </li>`;return $(m)}deleteComment(t){$(t).click((function(e){e.preventDefault(),$.ajax({type:"get",url:$(t).prop("href"),success:function(t){$(`#comment-${t.data.comment}`).remove(),new Noty({theme:"relax",text:"Comment Deleted",type:"success",layout:"topRight",timeout:1500}).show()},error:function(t){}})}))}}$((function(){$('form[id$="-comments-form"]').each(((t,e)=>new PostComments(e.id.split("-")[1])))}));